<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>AVS Furnishing Curtain Order</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 20px;
      background-color: #f0f4f8;
    }
    .header {
      text-align: center;
      margin-bottom: 20px;
    }
    .header img {
      height: 80px;
    }
    .header h1 {
      margin: 10px 0 0;
      font-size: 32px;
      color: #2c3e50;
    }
    .header p {
      margin: 5px 0;
      font-style: italic;
      color: #7f8c8d;
    }
    form {
      max-width: 900px;
      margin: 0 auto;
      background-color: #ffffff;
      padding: 25px;
      border-radius: 12px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.15);
    }
    label {
      display: block;
      margin-top: 15px;
      font-weight: bold;
      color: #34495e;
    }
    input[type="text"],
    input[type="number"],
    input[type="date"],
    select {
      width: 100%;
      padding: 10px;
      margin-top: 5px;
      border-radius: 6px;
      border: 1px solid #bdc3c7;
      background-color: #ecf0f1;
    }
    .result {
      margin-top: 30px;
      font-size: 16px;
      font-weight: bold;
      color: #27ae60;
      white-space: pre-wrap;
    }
    button {
      margin-top: 20px;
      padding: 12px 24px;
      font-size: 16px;
      border: none;
      border-radius: 6px;
      background-color: #2980b9;
      color: white;
      cursor: pointer;
    }
    button:hover {
      background-color: #1c5980;
    }
    .window-set {
      border: 1px solid #ccc;
      padding: 15px;
      margin-bottom: 20px;
      border-radius: 8px;
      background-color: #fdfdfd;
    }
  </style>
</head>
<body>
  <div class="header">
    <img src="avs-logo.jpg" alt="AVS Furnishings Logo" />
    <h1>AVS FURNISHINGS</h1>
    <p>MAKING HOMES EXTRA SPECIAL</p>
  </div>

  <form id="orderForm">
    <label>Customer Name:</label>
    <input type="text" id="customerName" required />

    <label>Date:</label>
    <input type="date" id="orderDate" required />

    <label>Phone Number:</label>
    <input type="text" id="phoneNumber" required />

    <div id="windowContainer"></div>

    <button type="button" onclick="addWindowSet()">Add Window</button>
    <button type="button" onclick="calculateTotal()">Calculate Total</button>
    <button type="button" onclick="exportPDF()">Export as PDF</button>

    <div class="result" id="output"></div>
  </form>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script>
    function addWindowSet() {
      const container = document.getElementById('windowContainer');
      const div = document.createElement('div');
      div.className = 'window-set';
      div.innerHTML = `
        <label>Window Location:</label>
        <input type="text" class="windowLocation" required />

        <label>Length (in inches):</label>
        <input type="number" class="length" required />

        <label>Breadth (in inches):</label>
        <input type="number" class="breadth" required />

        <label>Fabric Name:</label>
        <input type="text" class="fabricName" required />

        <label>Rate per Metre (₹):</label>
        <input type="number" class="ratePerMtr" required />

        <label>Fabric Discount (%):</label>
        <input type="number" class="fabricDiscount" value="0" required />

        <label>Stitching Type:</label>
        <select class="stitchingType">
          <option value="2 pleat">2 pleat</option>
          <option value="3 pleat">3 pleat</option>
          <option value="eyelet">Eyelet</option>
          <option value="ripple">Ripple</option>
        </select>

        <label>Lining Required:</label>
        <select class="lining">
          <option value="no">No</option>
          <option value="yes">Yes</option>
        </select>

        <label>Lining Type:</label>
        <select class="liningType">
          <option value="satin">Satin</option>
          <option value="blackout">Blackout</option>
        </select>

        <label>Number of Belts:</label>
        <input type="number" class="beltQty" value="0" />

        <label>Rod/Channel Type:</label>
        <select class="rodType">
          <option value="none">None</option>
          <option value="ss rod">SS Rod</option>
          <option value="j silent channel">J Silent Channel</option>
          <option value="al silent channel">AL Silent Channel</option>
        </select>
      `;
      container.appendChild(div);
    }

    function calculateTotal() {
      const windowSets = document.querySelectorAll('.window-set');
      let totalAmount = 0;
      let output = `Customer Name: ${document.getElementById('customerName').value}\nDate: ${document.getElementById('orderDate').value}\nPhone: ${document.getElementById('phoneNumber').value}\n\n`;

      windowSets.forEach((set, index) => {
        const length = parseFloat(set.querySelector('.length').value);
        const breadth = parseFloat(set.querySelector('.breadth').value);
        const fabricName = set.querySelector('.fabricName').value;
        const ratePerMtr = parseFloat(set.querySelector('.ratePerMtr').value);
        const fabricDiscount = parseFloat(set.querySelector('.fabricDiscount').value);
        const stitchingType = set.querySelector('.stitchingType').value;
        const lining = set.querySelector('.lining').value;
        const liningType = set.querySelector('.liningType').value;
        const beltQty = parseInt(set.querySelector('.beltQty').value);
        const rodType = set.querySelector('.rodType').value;

        const numCurtains = Math.ceil(breadth / 20);
        const fabricPerCurtain = (length + 12) / 39.5;
        const extraForBelts = Math.floor(beltQty / 2) * 0.5;
        const totalFabric = fabricPerCurtain * numCurtains + extraForBelts;
        const discountedRate = ratePerMtr - (ratePerMtr * fabricDiscount / 100);
        const fabricCost = totalFabric * discountedRate;

        let stitchingCost = 0;
        if (stitchingType === 'ripple') stitchingCost = lining === 'yes' ? 500 : 450;
        else stitchingCost = lining === 'yes' ? 250 : 200;
        stitchingCost *= numCurtains;

        let liningCost = 0;
        if (lining === 'yes') {
          const liningRate = liningType === 'satin' ? 180 : 250;
          liningCost = totalFabric * liningRate;
        }

        const beltCost = beltQty * 200;

        let rodCost = 0;
        const rodLengthFt = breadth / 12;
        if (rodType === 'ss rod') rodCost = rodLengthFt * 195;
        else if (rodType === 'j silent channel') rodCost = rodLengthFt * 210;
        else if (rodType === 'al silent channel') rodCost = rodLengthFt * 350;

        const subtotal = fabricCost + stitchingCost + liningCost + beltCost + rodCost;
        totalAmount += subtotal;

        output += `Window ${index + 1} (${set.querySelector('.windowLocation').value}):\n`;
        output += `  No. of Curtains: ${numCurtains}\n`;
        output += `  Fabric per Curtain (m): ${fabricPerCurtain.toFixed(2)}\n`;
        output += `  Total Fabric (m): ${totalFabric.toFixed(2)}\n`;
        output += `  Fabric Cost: ₹${fabricCost.toFixed(0)}\n`;
        output += `  Stitching Cost: ₹${stitchingCost.toFixed(0)}\n`;
        output += `  Lining Cost: ₹${liningCost.toFixed(0)}\n`;
        output += `  Belt Stitching Cost: ₹${beltCost.toFixed(0)}\n`;
        output += `  Rod/Channel Cost: ₹${rodCost.toFixed(0)}\n`;
        output += `  Subtotal: ₹${subtotal.toFixed(0)}\n\n`;
      });

      output += `Total Estimate: ₹${totalAmount.toFixed(0)}`;
      document.getElementById('output').textContent = output;
    }

    function exportPDF() {
      const { jsPDF } = window.jspdf;
      const doc = new jsPDF({ unit: 'pt', format: 'a4' });
      const marginLeft = 40;
      const topMargin = 40;
      const lineHeight = 20;
      const maxWidth = 520;
      const fontSize = 11;

      doc.setFont('helvetica', 'normal');
      doc.setFontSize(fontSize);

      const text = `AVS FURNISHINGS\n\n` + document.getElementById('output').textContent;
      const lines = doc.splitTextToSize(text, maxWidth);

      lines.forEach((line, i) => {
        doc.text(line, marginLeft, topMargin + (i * lineHeight));
      });

      doc.save('curtain_order_summary.pdf');
    }
  </script>
</body>
</html>


