<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>AVS Furnishing Curtain Order</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 20px;
      background-color: #f0f4f8;
    }
    .header {
      text-align: center;
      margin-bottom: 20px;
    }
    .header img {
      height: 80px;
    }
    .header h1 {
      margin: 10px 0 0;
      font-size: 32px;
      color: #2c3e50;
    }
    .header p {
      margin: 5px 0;
      font-style: italic;
      color: #7f8c8d;
    }
    form {
      max-width: 900px;
      margin: 0 auto;
      background-color: #ffffff;
      padding: 25px;
      border-radius: 12px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.15);
    }
    label {
      display: block;
      margin-top: 15px;
      font-weight: bold;
      color: #34495e;
    }
    input[type="text"],
    input[type="number"],
    input[type="date"],
    select {
      width: 100%;
      padding: 12px;
      margin-top: 5px;
      border-radius: 6px;
      border: 1px solid #bdc3c7;
      background-color: #ecf0f1;
      font-size: 16px;
    }
    .result {
      margin-top: 30px;
      font-size: 16px;
      font-weight: bold;
      color: #27ae60;
      white-space: pre-wrap;
      background: #dff0d8;
      padding: 15px;
      border-radius: 8px;
      border: 1px solid #c3e6cb;
      min-height: 100px;
    }
    button {
      margin-top: 20px;
      padding: 14px 28px;
      font-size: 18px;
      border: none;
      border-radius: 6px;
      background-color: #2980b9;
      color: white;
      cursor: pointer;
      margin-right: 10px;
    }
    button:hover {
      background-color: #1c5980;
    }
    .window-set {
      border: 1px solid #ccc;
      padding: 15px;
      margin-bottom: 20px;
      border-radius: 8px;
      background-color: #fdfdfd;
    }
    @media (max-width: 600px) {
      body {
        margin: 10px;
      }
      form {
        padding: 20px;
      }
      input[type="text"],
      input[type="number"],
      input[type="date"],
      select {
        font-size: 18px;
      }
      button {
        width: 100%;
        margin-top: 15px;
        margin-right: 0;
      }
    }
  </style>
</head>
<body>
  <div class="header">
    <img src="avs-logo.jpg" alt="AVS Furnishings Logo" />
    <h1>AVS FURNISHINGS</h1>
    <p>MAKING HOMES EXTRA SPECIAL</p>
  </div>
  <form id="orderForm">
    <label>Customer Name:</label>
    <input type="text" id="customerName" required />

    <label>Date:</label>
    <input type="date" id="orderDate" required />

    <label>Phone Number:</label>
    <input type="text" id="phoneNumber" required />

    <div id="windowContainer"></div>

    <button type="button" onclick="addWindowSet()">Add Window</button>
    <button type="button" onclick="calculateTotal()">Calculate Total</button>
    <button type="button" onclick="exportPDF()">Export as PDF</button>

    <div class="result" id="output"></div>
  </form>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script>
    function addWindowSet() {
      const container = document.getElementById('windowContainer');
      const div = document.createElement('div');
      div.className = 'window-set';
      div.innerHTML = `
        <label>Window Location:</label>
        <input type="text" class="windowLocation" required />

        <label>Length (in inches):</label>
        <input type="number" class="length" required />

        <label>Breadth (in inches):</label>
        <input type="number" class="breadth" required />

        <label>Fabric Name:</label>
        <input type="text" class="fabricName" required />

        <label>Rate per Metre (₹):</label>
        <input type="number" class="ratePerMtr" required />

        <label>Fabric Discount (%):</label>
        <input type="number" class="fabricDiscount" value="0" max="20" required oninput="validateDiscount(this)" />

        <label>Stitching Type:</label>
        <select class="stitchingType">
          <option value="2 pleat">2 pleat</option>
          <option value="3 pleat">3 pleat</option>
          <option value="eyelet">Eyelet</option>
          <option value="ripple">Ripple</option>
        </select>

        <label>Lining Required:</label>
        <select class="lining">
          <option value="no">No</option>
          <option value="yes">Yes</option>
        </select>

        <label>Lining Type:</label>
        <select class="liningType">
          <option value="satin">Satin</option>
          <option value="blackout">Blackout</option>
        </select>

        <label>Number of Belts:</label>
        <input type="number" class="beltQty" value="0" />

        <label>Rod/Channel Type:</label>
        <select class="rodType">
          <option value="none">None</option>
          <option value="ss rod">SS Rod</option>
          <option value="j silent channel">J Silent Channel</option>
          <option value="al silent channel">AL Silent Channel</option>
        </select>
      `;
      container.appendChild(div);
    }

    function validateDiscount(input) {
      if (parseFloat(input.value) > 20) {
        input.value = 20;
        showToast("Fabric discount cannot be more than 20%!");
      }
    }

    function showToast(message) {
      const toast = document.createElement('div');
      toast.textContent = message;
      toast.style.position = 'fixed';
      toast.style.bottom = '30px';
      toast.style.left = '50%';
      toast.style.transform = 'translateX(-50%)';
      toast.style.background = '#e74c3c';
      toast.style.color = 'white';
      toast.style.padding = '10px 20px';
      toast.style.borderRadius = '8px';
      toast.style.fontSize = '16px';
      toast.style.zIndex = '1000';
      toast.style.boxShadow = '0 4px 8px rgba(0,0,0,0.2)';
      toast.style.animation = 'fadeInOut 2.5s';
      document.body.appendChild(toast);
      setTimeout(() => { toast.remove(); }, 2500);
    }

    function calculateTotal() {
      const windows = document.querySelectorAll('.window-set');
      let grandTotal = 0;
      let output = '';
      windows.forEach((window, i) => {
        const location = window.querySelector('.windowLocation').value || `Window ${i+1}`;
        const length = parseFloat(window.querySelector('.length').value) || 0;
        const breadth = parseFloat(window.querySelector('.breadth').value) || 0;
        const ratePerMtr = parseFloat(window.querySelector('.ratePerMtr').value) || 0;
        const fabricDiscount = parseFloat(window.querySelector('.fabricDiscount').value) || 0;
        const stitchingType = window.querySelector('.stitchingType').value;
        const liningRequired = window.querySelector('.lining').value;
        const liningType = window.querySelector('.liningType').value;
        const beltQty = parseInt(window.querySelector('.beltQty').value) || 0;
        const rodType = window.querySelector('.rodType').value;

        const panelWidth = 20; // inches per curtain panel
        const curtainsCount = Math.ceil(breadth / panelWidth);

        // Fabric length per curtain (length + 12 inches) converted to meters (1 m = 39.5 inches)
        const fabricLengthMtrPerCurtain = (length + 12) / 39.5;

        // Total fabric required in meters
        const totalFabricMtr = fabricLengthMtrPerCurtain * curtainsCount;

        // Cost before discount
        let fabricCost = totalFabricMtr * ratePerMtr;

        // Apply fabric discount
        fabricCost = fabricCost * (1 - fabricDiscount / 100);

        // Lining cost per meter (just example rates)
        let liningCostPerMtr = 0;
        if(liningRequired === "yes"){
          if(liningType === "satin") liningCostPerMtr = 100;
          else if(liningType === "blackout") liningCostPerMtr = 200;
        }

        const totalLiningCost = liningCostPerMtr * totalFabricMtr;

        // Stitching cost per curtain panel (example rates)
        let stitchingCostPerCurtain = 0;
        switch(stitchingType){
          case "2 pleat": stitchingCostPerCurtain = 50; break;
          case "3 pleat": stitchingCostPerCurtain = 70; break;
          case "eyelet": stitchingCostPerCurtain = 60; break;
          case "ripple": stitchingCostPerCurtain = 80; break;
        }
        const totalStitchingCost = stitchingCostPerCurtain * curtainsCount;

        // Belts cost (example ₹50 each)
        const beltCost = beltQty * 50;

        // Calculate grand total for this window
        const windowTotal = fabricCost + totalLiningCost + totalStitchingCost + beltCost;

        grandTotal += windowTotal;

        output += `Window: ${location}
  - Fabric Required per Curtain (m): ${fabricLengthMtrPerCurtain.toFixed(2)}
  - Number of Curtains: ${curtainsCount}
  - Total Fabric Required (m): ${totalFabricMtr.toFixed(2)}
  - Number of Belts: ${beltQty}
  - Total Lining Required (m): ${liningRequired === "yes" ? totalFabricMtr.toFixed(2) : '0'}
  - Cost of Lining (₹): ${totalLiningCost.toFixed(2)}
  - Type of Pleat: ${stitchingType}
  - Type of Stitching Cost per Curtain (₹): ${stitchingCostPerCurtain}
  - Total Stitching Cost (₹): ${totalStitchingCost.toFixed(2)}
  - Fabric Cost after Discount (₹): ${fabricCost.toFixed(2)}
  - Belt Cost (₹): ${beltCost.toFixed(2)}
  - Subtotal (₹): ${windowTotal.toFixed(2)}

`;
      });

      output += `GRAND TOTAL (₹): ${grandTotal.toFixed(2)}`;
      document.getElementById('output').innerText = output;
    }

    async function exportPDF() {
      const { jsPDF } = window.jspdf;
      const doc = new jsPDF();

      const customerName = document.getElementById('customerName').value || 'N/A';
      const orderDate = document.getElementById('orderDate').value || 'N/A';
      const phoneNumber = document.getElementById('phoneNumber').value || 'N/A';
      const outputText = document.getElementById('output').innerText || 'Please calculate total first!';

      if(outputText === 'Please calculate total first!') {
        alert('Please calculate the total before exporting PDF.');
        return;
      }

      let y = 10;
      doc.setFontSize(18);
      doc.text("AVS Furnishings", 105, y, null, null, 'center');
      y += 10;
      doc.setFontSize(12);
      doc.text("MAKING HOMES EXTRA SPECIAL", 105, y, null, null, 'center');
      y += 15;

      doc.setFontSize(14);
      doc.text(`Customer Name: ${customerName}`, 10, y);
      y += 10;
      doc.text(`Order Date: ${orderDate}`, 10, y);
      y += 10;
      doc.text(`Phone Number: ${phoneNumber}`, 10, y);
      y += 15;

      doc.setFontSize(12);

      const lines = doc.splitTextToSize(outputText, 180);
      doc.text(lines, 10, y);

      doc.save(`AVS_Curtain_Order_${customerName}_${orderDate}.pdf`);
    }

    // Start with 1 window set by default
    addWindowSet();
  </script>
</body>
</html>


